<Window x:Class="SiemensS7DemoConnection.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SiemensS7DemoConnection"
        mc:Ignorable="d"
        Title="S7 PLC Connection Demo" Height="700" Width="800">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
        <local:InverseBooleanToVisibilityConverter x:Key="InverseBoolToVisConverter"/>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Connection Settings -->
        <GroupBox Header="Connection Settings" Grid.Row="0" Margin="0,0,0,10">
            <Grid Margin="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Content="IP Address:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                <TextBox Text="{Binding IpAddress}" Grid.Row="0" Grid.Column="1" Margin="5"/>

                <Label Content="CPU Type:" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center"/>
                <TextBox Text="{Binding Cpu}" Grid.Row="0" Grid.Column="3" Margin="5"/>

                <Label Content="Rack:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                <TextBox Text="{Binding Rack}" Grid.Row="1" Grid.Column="1" Margin="5"/>

                <Label Content="Slot:" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
                <TextBox Text="{Binding Slot}" Grid.Row="1" Grid.Column="3" Margin="5"/>

                <Button x:Name="btnConnect" Content="Connect" Grid.Row="0" Grid.Column="4" 
                        Grid.RowSpan="2" Width="100" Height="30" Margin="10,0,0,0"
                        Click="btnConnect_Click"/>
            </Grid>
        </GroupBox>

        <!-- Wrapper Version Selection -->
        <GroupBox Header="Wrapper Version" Grid.Row="1" Margin="0,0,0,10">
            <ComboBox ItemsSource="{Binding AvailableWrapperVersions}" 
                      SelectedItem="{Binding SelectedWrapperVersion}"
                      Margin="5" Padding="5" Height="30"/>
        </GroupBox>

        <!-- Data Type Selection -->
        <GroupBox Header="Data Type" Grid.Row="2" Margin="0,0,0,10">
            <ComboBox ItemsSource="{Binding AvailableDataTypes}" 
                      SelectedItem="{Binding SelectedDataType}"
                      Margin="5" Padding="5" Height="30"/>
        </GroupBox>

        <!-- Read/Write Operations -->
        <GroupBox Header="Read/Write Operations" Grid.Row="3" Margin="0,0,0,10">
            <Grid Margin="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Read Operations -->
                <Label Content="Read Address:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                <TextBox Text="{Binding ReadAddress}" Grid.Row="0" Grid.Column="1" Margin="5"/>
                <Button x:Name="btnRead" Content="Read" Grid.Row="0" Grid.Column="2" 
                        Width="80" Margin="5" Click="btnRead_Click"/>

                <Label Content="Read Value:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                <TextBox Text="{Binding ReadValue}" Grid.Row="1" Grid.Column="1" 
                         Grid.ColumnSpan="2" Margin="5" IsReadOnly="True"/>

                <!-- Write Operations -->
                <Label Content="Write Address:" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
                <TextBox Text="{Binding WriteAddress}" Grid.Row="2" Grid.Column="1" Margin="5"/>
                <Button x:Name="btnWrite" Content="Write" Grid.Row="2" Grid.Column="2" 
                        Width="80" Margin="5" Click="btnWrite_Click"/>

                <!-- Different write value editors based on selected type -->
                <!-- Default String input -->
                <Label Content="Write Value:" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"
                       Visibility="{Binding IsDateTimeSelected, Converter={StaticResource InverseBoolToVisConverter}}"/>
                <TextBox Text="{Binding WriteValue}" Grid.Row="3" Grid.Column="1" 
                         Grid.ColumnSpan="2" Margin="5"
                         Visibility="{Binding IsDateTimeSelected, Converter={StaticResource InverseBoolToVisConverter}}"/>

                <!-- DateTime Picker -->
                <Label Content="Write DateTime:" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"
                       Visibility="{Binding IsDateTimeSelected, Converter={StaticResource BoolToVisConverter}}"/>
                <DatePicker SelectedDate="{Binding WriteDateTime}" Grid.Row="3" Grid.Column="1" Margin="5"
                            Visibility="{Binding IsDateTimeSelected, Converter={StaticResource BoolToVisConverter}}"/>
                <TextBox Text="{Binding WriteDateTime, StringFormat=HH:mm:ss}"
                         Grid.Row="3" Grid.Column="2" Margin="5" Width="80"
                         Visibility="{Binding IsDateTimeSelected, Converter={StaticResource BoolToVisConverter}}"/>

                <!-- Double Value Input -->
                <Label Content="Write Double:" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"
                       Visibility="{Binding IsDoubleSelected, Converter={StaticResource BoolToVisConverter}}"/>
                <TextBox Text="{Binding WriteDouble}" Grid.Row="4" Grid.Column="1" 
                         Grid.ColumnSpan="2" Margin="5"
                         Visibility="{Binding IsDoubleSelected, Converter={StaticResource BoolToVisConverter}}"/>

                <!-- Word Value Input -->
                <Label Content="Write Word:" Grid.Row="5" Grid.Column="0" VerticalAlignment="Center"
                       Visibility="{Binding IsWordSelected, Converter={StaticResource BoolToVisConverter}}"/>
                <TextBox Text="{Binding WriteInt}" Grid.Row="5" Grid.Column="1" 
                         Grid.ColumnSpan="2" Margin="5"
                         Visibility="{Binding IsWordSelected, Converter={StaticResource BoolToVisConverter}}"/>
            </Grid>
        </GroupBox>

        <!-- Results Area -->
        <GroupBox Header="Process Results" Grid.Row="4">
            <TextBox Text="{Binding ProcessResult}" Margin="5" 
                     IsReadOnly="True" TextWrapping="Wrap"
                     VerticalScrollBarVisibility="Auto"/>
        </GroupBox>
    </Grid>
</Window>